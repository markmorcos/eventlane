@if (event(); as evt) {
<div class="admin-event">
  <div class="header">
    <h2>Manage: {{ evt.title }}</h2>
    <button class="secondary" [routerLink]="['/events', evt.slug]">
      Back to event
    </button>
  </div>

  <div class="card">
    <div class="capacity-warning">
      <p class="info-text">
        <strong>Note:</strong> Adjusting capacity will automatically manage
        attendee status. Reducing capacity moves confirmed attendees to the
        waitlist, while increasing capacity promotes waitlisted attendees to
        confirmed status.
      </p>
    </div>
    <h3>Capacity management</h3>
    <form class="capacity-control">
      <input
        name="capacity"
        type="number"
        [(ngModel)]="newCapacity"
        min="0"
        placeholder="Capacity"
      />
      <button class="primary" (click)="updateCapacity()" [disabled]="loading()">
        Update capacity
      </button>
    </form>
  </div>

  <div class="card">
    <h3>Confirmed attendees ({{ confirmed().length }})</h3>
    @if (confirmed().length) {
    <div class="attendees-table">
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Registered</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (attendee of confirmed(); track attendee.id) {
          <tr>
            <td>{{ attendee.name }}</td>
            <td>{{ attendee.email }}</td>
            <td>{{ attendee.createdAt | date : "dd.MM.yyyy HH:mm:ss" }}</td>
            <td>
              <button
                class="danger small"
                (click)="removeAttendee(attendee.email)"
              >
                Remove
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    } @else {
    <p>No confirmed attendees</p>
    }
  </div>

  <div class="card">
    <h3>Waitlisted attendees ({{ waitlisted().length }})</h3>
    @if (waitlisted().length) {
    <div class="attendees-table">
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Registered</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (attendee of waitlisted(); track attendee.id) {
          <tr>
            <td>{{ attendee.name }}</td>
            <td>{{ attendee.email }}</td>
            <td>{{ attendee.createdAt | date : "dd.MM.yyyy HH:mm:ss" }}</td>
            <td>
              <button
                class="danger small"
                (click)="removeAttendee(attendee.email)"
              >
                Remove
              </button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
    } @else {
    <p>No waitlisted attendees</p>
    }
  </div>

  <div class="card">
    <h3>Admin management</h3>
    @if (admins().length) {
    <div class="admin-list">
      @for (admin of admins(); track admin) {
      <div class="admin-item">
        <span>{{ admin }}</span>
        <button class="danger small" (click)="removeAdmin(admin)">
          Remove
        </button>
      </div>
      }
    </div>
    }
    <form class="add-admin" (ngSubmit)="addAdmin()">
      <input
        type="email"
        name="email"
        [(ngModel)]="newAdminEmail"
        placeholder="Admin email"
      />
      <button
        type="submit"
        class="primary"
        [disabled]="!newAdminEmail || loading()"
      >
        Add admin
      </button>
    </form>
  </div>

  @if (event()?.creatorEmail === email()) {
  <div class="card danger-zone">
    <h3>Danger zone</h3>
    <button class="danger" (click)="deleteEvent()">Delete event</button>
  </div>
  }
</div>
}
